diff --git a/db/derby/code/branches/10.1/java/client/org/apache/derby/client/am/PreparedStatement.java b/db/derby/code/branches/10.1/java/client/org/apache/derby/client/am/PreparedStatement.java
index 0e412071..412a5b55 100644
--- a/db/derby/code/branches/10.1/java/client/org/apache/derby/client/am/PreparedStatement.java
+++ b/db/derby/code/branches/10.1/java/client/org/apache/derby/client/am/PreparedStatement.java
@@ -1367,7 +1367,7 @@ void flowExecute(int executeType) throws SqlException {
                 connection_.completeTransactionStart();
             }
 
-            super.markResultSetsClosed();
+            super.markResultSetsClosed(true); // true means remove from list of commit and rollback listeners
 
             switch (sqlMode_) {
             case isUpdate__:
diff --git a/db/derby/code/branches/10.1/java/client/org/apache/derby/client/am/ResultSet.java b/db/derby/code/branches/10.1/java/client/org/apache/derby/client/am/ResultSet.java
index c67b25e3..f2ff622c 100644
--- a/db/derby/code/branches/10.1/java/client/org/apache/derby/client/am/ResultSet.java
+++ b/db/derby/code/branches/10.1/java/client/org/apache/derby/client/am/ResultSet.java
@@ -388,8 +388,7 @@ public final void closeX() throws SqlException {
                 flowAutoCommitIfNotAutoCommitted(); // in case of early close
             }
         } finally {
-            markClosed();
-            connection_.CommitAndRollbackListeners_.remove(this);
+            markClosed(true);
         }
 
         flowAutoCommitIfLastOpenMultipleResultSetWasJustClosed();
@@ -3014,12 +3013,31 @@ private void nullOutReferenceInStatement() {
         }
     }
 
+    /**
+     * Mark this ResultSet as closed. The ResultSet will not be
+     * removed from the commit and rollback listeners list in
+     * <code>org.apache.derby.client.am.Connection</code>.
+     */
     void markClosed() {
+        markClosed(false);
+    }
+
+    /**
+     * Mark this ResultSet as closed.
+     *
+     * @param removeListener if true the ResultSet will be removed
+     * from the commit and rollback listeners list in
+     * <code>org.apache.derby.client.am.Connection</code>.
+     */
+    void markClosed(boolean removeListener) {
         openOnClient_ = false;
         openOnServer_ = false;
         statement_.resetCursorNameAndRemoveFromWhereCurrentOfMappings(); // for SELECT...FOR UPDATE queries
         statement_.removeClientCursorNameFromCache();
         markPositionedUpdateDeletePreparedStatementsClosed();
+        if (removeListener) {
+            connection_.CommitAndRollbackListeners_.remove(this);
+        }
     }
 
     void markClosedOnServer() {
diff --git a/db/derby/code/branches/10.1/java/client/org/apache/derby/client/am/Statement.java b/db/derby/code/branches/10.1/java/client/org/apache/derby/client/am/Statement.java
index bbae95d7..cfcab8a8 100644
--- a/db/derby/code/branches/10.1/java/client/org/apache/derby/client/am/Statement.java
+++ b/db/derby/code/branches/10.1/java/client/org/apache/derby/client/am/Statement.java
@@ -1393,20 +1393,38 @@ void markPreparedStatementForAutoGeneratedKeysClosed() {
         }
     }
 
+    /**
+     * Mark all ResultSets associated with this statement as
+     * closed. The ResultSets will not be removed from the commit and
+     * rollback listeners list in
+     * <code>org.apache.derby.client.am.Connection</code>.
+     */
     void markResultSetsClosed() {
+        markResultSetsClosed(false);
+    }
+
+    /**
+     * Mark all ResultSets associated with this statement as
+     * closed.
+     *
+     * @param removeListener if true the ResultSets will be removed
+     * from the commit and rollback listeners list in
+     * <code>org.apache.derby.client.am.Connection</code>.
+     */
+    void markResultSetsClosed(boolean removeListener) {
         if (resultSetList_ != null) {
             for (int i = 0; i < resultSetList_.length; i++) {
                 if (resultSetList_[i] != null) {
-                    resultSetList_[i].markClosed();
+                    resultSetList_[i].markClosed(removeListener);
                 }
                 resultSetList_[i] = null;
             }
         }
         if (generatedKeysResultSet_ != null) {
-            generatedKeysResultSet_.markClosed();
+            generatedKeysResultSet_.markClosed(removeListener);
         }
         if (resultSet_ != null) {
-            resultSet_.markClosed();
+            resultSet_.markClosed(removeListener);
         }
         resultSet_ = null;
         resultSetList_ = null;
@@ -1544,7 +1562,7 @@ else if (sqlUpdateMode_ == isInsertSql__ && generatedKeysColumnNames_ != null) {
                 connection_.completeTransactionStart();
             }
 
-            markResultSetsClosed();
+            markResultSetsClosed(true); // true means remove from list of commit and rollback listeners
             markClosedOnServer();
             section_ = newSection;
 
