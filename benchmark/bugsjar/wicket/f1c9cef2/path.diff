diff --git a/wicket-core/src/main/java/org/apache/wicket/Component.java b/wicket-core/src/main/java/org/apache/wicket/Component.java
index 13b32cb..5f0a97d 100644
--- a/wicket-core/src/main/java/org/apache/wicket/Component.java
+++ b/wicket-core/src/main/java/org/apache/wicket/Component.java
@@ -3207,23 +3207,22 @@ public String toString(final boolean detailed)
 	{
 		try
 		{
+			final StringBuilder buffer = new StringBuilder();
+			buffer.append("[Component id = ").append(getId());
+
 			if (detailed)
 			{
 				final Page page = findPage();
 				if (page == null)
 				{
-					return new StringBuilder("[Component id = ").append(getId())
-						.append(", page = <No Page>, path = ")
+					buffer.append(", page = <No Page>, path = ")
 						.append(getPath())
 						.append('.')
-						.append(Classes.simpleName(getClass()))
-						.append(']')
-						.toString();
+						.append(Classes.simpleName(getClass()));
 				}
 				else
 				{
-					return new StringBuilder("[Component id = ").append(getId())
-						.append(", page = ")
+					buffer.append(", page = ")
 						.append(getPage().getClass().getName())
 						.append(", path = ")
 						.append(getPath())
@@ -3232,15 +3231,18 @@ public String toString(final boolean detailed)
 						.append(", isVisible = ")
 						.append((determineVisibility()))
 						.append(", isVersioned = ")
-						.append(isVersioned())
-						.append(']')
-						.toString();
-				}
+						.append(isVersioned());
 				}
-			else
+
+				if (markup != null)
 				{
-				return "[Component id = " + getId() + ']';
+					buffer.append(", markup = ").append(new MarkupStream(getMarkup()).toString());
+				}
 			}
+
+			buffer.append(']');
+
+			return buffer.toString();
 		}
 		catch (Exception e)
 		{
diff --git a/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java b/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java
index 056d483..f992264 100644
--- a/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java
+++ b/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java
@@ -860,17 +860,11 @@ public String toString()
 	public String toString(final boolean detailed)
 	{
 		final StringBuilder buffer = new StringBuilder();
-		buffer.append("[").append(this.getClass().getSimpleName()).append(" ");
+		buffer.append('[').append(this.getClass().getSimpleName()).append(' ');
 		buffer.append(super.toString(detailed));
-		if (detailed)
+		if (detailed && children_size() != 0)
 		{
-			if (getMarkup() != null)
-			{
-				buffer.append(", markup = ").append(new MarkupStream(getMarkup()).toString());
-			}
 
-			if (children_size() != 0)
-			{
 			buffer.append(", children = ");
 
 			// Loop through child components
@@ -885,7 +879,7 @@ public String toString(final boolean detailed)
 				}
 				buffer.append(child.toString());
 			}
-			}
+
 		}
 		buffer.append(']');
 		return buffer.toString();
