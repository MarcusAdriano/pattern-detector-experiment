diff --git a/wicket-core/src/main/java/org/apache/wicket/protocol/http/request/UserAgent.java b/wicket-core/src/main/java/org/apache/wicket/protocol/http/request/UserAgent.java
index 4c663d3..b6c028a 100644
--- a/wicket-core/src/main/java/org/apache/wicket/protocol/http/request/UserAgent.java
+++ b/wicket-core/src/main/java/org/apache/wicket/protocol/http/request/UserAgent.java
@@ -96,16 +96,20 @@ public boolean matches(String userAgent)
 
 		for (List<String> detectionGroup : detectionStrings)
 		{
+			boolean groupPassed = true;
 			for (String detectionString : detectionGroup)
 			{
 				if (!userAgent.contains(detectionString))
 				{
-					return false;
+					groupPassed = false;
+					break;
 				}
 			}
-
+			if (groupPassed)
+			{
 				return true;
 			}
+		}
 
 		return false;
 	}
